# ============================================
# EJEMPLO: Azure Function Deployment Workflow
# ============================================
# üìã INSTRUCCIONES:
# 1. Copia este archivo a: .github/workflows/deploy.yml en tu proyecto
# 2. Reemplaza los valores marcados con ‚ö†Ô∏è CAMBIAR
# 3. Ajusta las ramas seg√∫n tu estrategia (develop/staging/main)
# 4. ¬°Listo! No necesitas configurar secretos (est√°n centralizados)

name: Deploy Azure Function

on:
  push:
    branches:
      - develop    # Auto-deploy to dev
      - staging    # Auto-deploy to staging
      - main       # Auto-deploy to production

jobs:
  # ========================================
  # AMBIENTE: DESARROLLO
  # ========================================
  deploy-dev:
    if: github.ref == 'refs/heads/develop'
    uses: YOUR-ORG/azure-workflow-actions/.github/workflows/deploy-function.yml@main  # ‚ö†Ô∏è CAMBIAR: YOUR-ORG por tu organizaci√≥n
    with:
      # ‚ö†Ô∏è CAMBIAR estos valores seg√∫n tu proyecto:
      function-app-name: 'mi-function-dev'              # Nombre de tu Azure Function en dev
      resource-group: 'mi-rg-dev'                       # Resource Group de dev
      package-path: './mi-funcion'                      # Ruta a tu carpeta de funci√≥n
      
      # ‚úÖ Opcionales - ajusta seg√∫n necesites:
      environment: 'dev'
      node-version: '18.x'                              # Cambia si usas otra versi√≥n
      run-tests: true
      enable-notifications: true
      create-release-on-success: true

  # ========================================
  # AMBIENTE: STAGING
  # ========================================
  deploy-staging:
    if: github.ref == 'refs/heads/staging'
    uses: YOUR-ORG/azure-workflow-actions/.github/workflows/deploy-function.yml@main  # ‚ö†Ô∏è CAMBIAR: YOUR-ORG por tu organizaci√≥n
    with:
      # ‚ö†Ô∏è CAMBIAR estos valores seg√∫n tu proyecto:
      function-app-name: 'mi-function-staging'
      resource-group: 'mi-rg-staging'
      package-path: './mi-funcion'
      
      # ‚úÖ Opcionales - ajusta seg√∫n necesites:
      environment: 'staging'
      node-version: '18.x'
      run-tests: true
      enable-notifications: true
      slot-name: 'staging'                              # Deploy a slot de staging
      create-release-on-success: true

  # ========================================
  # AMBIENTE: PRODUCCI√ìN
  # ========================================
  deploy-prod:
    if: github.ref == 'refs/heads/main'
    uses: YOUR-ORG/azure-workflow-actions/.github/workflows/deploy-function.yml@main  # ‚ö†Ô∏è CAMBIAR: YOUR-ORG por tu organizaci√≥n
    with:
      # ‚ö†Ô∏è CAMBIAR estos valores seg√∫n tu proyecto:
      function-app-name: 'mi-function-prod'
      resource-group: 'mi-rg-prod'
      package-path: './mi-funcion'
      
      # ‚úÖ Opcionales - ajusta seg√∫n necesites:
      environment: 'prod'
      node-version: '18.x'
      run-tests: true
      enable-notifications: true
      create-release-on-success: true                   # Crea release oficial

# ============================================
# üí° NOTAS:
# - NO necesitas configurar secrets en tu repo
# - Todos los secrets est√°n en azure-workflow-actions
# - Puedes eliminar ambientes que no uses (dev/staging/prod)
# ============================================
