# ============================================
# EJEMPLO: Spring Boot API Deployment Workflow
# ============================================
# üìã INSTRUCCIONES:
# 1. Copia este archivo a: .github/workflows/deploy.yml en tu proyecto
# 2. Reemplaza los valores marcados con ‚ö†Ô∏è CAMBIAR
# 3. Ajusta las ramas seg√∫n tu estrategia (develop/main)
# 4. ¬°Listo! No necesitas configurar secretos (est√°n centralizados)

name: Deploy Spring API

on:
  push:
    branches:
      - develop    # Auto-deploy a dev
      - staging    # Auto-deploy a staging
      - main       # Auto-deploy a production

jobs:
  # ========================================
  # AMBIENTE: DESARROLLO
  # ========================================
  deploy-dev:
    if: github.ref == 'refs/heads/develop'
    uses: YOUR-ORG/azure-workflow-actions/.github/workflows/deploy-spring-api.yml@main  # ‚ö†Ô∏è CAMBIAR: YOUR-ORG por tu organizaci√≥n
    with:
      # ‚ö†Ô∏è CAMBIAR estos valores seg√∫n tu proyecto:
      app-name: 'mi-api-dev'                            # Nombre de tu App Service en dev
      resource-group: 'mi-rg-dev'                       # Resource Group de dev
      package-path: './target/mi-api-*.jar'             # Ruta a tu JAR (ajusta el nombre)
      
      # ‚úÖ Opcionales - ajusta seg√∫n necesites:
      environment: 'dev'
      java-version: '17'                                # Cambia si usas Java 11, 21, etc.
      build-tool: 'maven'                               # O 'gradle' si usas Gradle
      run-tests: true
      enable-notifications: true
      create-release-on-success: true

  # ========================================
  # AMBIENTE: STAGING
  # ========================================
  deploy-staging:
    if: github.ref == 'refs/heads/staging'
    uses: YOUR-ORG/azure-workflow-actions/.github/workflows/deploy-spring-api.yml@main  # ‚ö†Ô∏è CAMBIAR: YOUR-ORG por tu organizaci√≥n
    with:
      # ‚ö†Ô∏è CAMBIAR estos valores seg√∫n tu proyecto:
      app-name: 'mi-api-staging'
      resource-group: 'mi-rg-staging'
      package-path: './target/mi-api-*.jar'
      
      # ‚úÖ Opcionales - ajusta seg√∫n necesites:
      environment: 'staging'
      java-version: '17'
      build-tool: 'maven'                               # O 'gradle'
      run-tests: true
      enable-notifications: true
      slot-name: 'staging'                              # Deploy a slot de staging
      create-release-on-success: true

  # ========================================
  # AMBIENTE: PRODUCCI√ìN
  # ========================================
  deploy-prod:
    if: github.ref == 'refs/heads/main'
    uses: YOUR-ORG/azure-workflow-actions/.github/workflows/deploy-spring-api.yml@main  # ‚ö†Ô∏è CAMBIAR: YOUR-ORG por tu organizaci√≥n
    with:
      # ‚ö†Ô∏è CAMBIAR estos valores seg√∫n tu proyecto:
      app-name: 'mi-api-prod'
      resource-group: 'mi-rg-prod'
      package-path: './target/mi-api-*.jar'
      
      # ‚úÖ Opcionales - ajusta seg√∫n necesites:
      environment: 'prod'
      java-version: '17'
      build-tool: 'maven'                               # O 'gradle'
      run-tests: true
      enable-notifications: true
      create-release-on-success: true                   # Crea release oficial

# ============================================
# üí° NOTAS:
# - NO necesitas configurar secrets en tu repo
# - Todos los secrets est√°n en azure-workflow-actions
# - Puedes eliminar ambientes que no uses (dev/staging/prod)
# - Para Gradle: cambia build-tool a 'gradle' y package-path a './build/libs/*.jar'
# ============================================
